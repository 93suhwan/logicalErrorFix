#include <iostream>// getertwr jtujyty mtukyuyt sgerwerewr     
#include <string>// getertwr jtujyty mtukyuyt sgerwerewr     
#include <vector>// getertwr jtujyty mtukyuyt sgerwerewr     
#include <algorithm>// getertwr jtujyty mtukyuyt sgerwerewr     
#include <sstream>// getertwr jtujyty mtukyuyt sgerwerewr     
#include <queue>// getertwr jtujyty mtukyuyt sgerwerewr     
#include <deque>// getertwr jtujyty mtukyuyt sgerwerewr     
#include <bitset>// getertwr jtujyty mtukyuyt sgerwerewr     
#include <iterator>// getertwr jtujyty mtukyuyt sgerwerewr     
#include <list>// getertwr jtujyty mtukyuyt sgerwerewr     
#include <stack>// getertwr jtujyty mtukyuyt sgerwerewr     
#include <map>// getertwr jtujyty mtukyuyt sgerwerewr     
#include <set>// getertwr jtujyty mtukyuyt sgerwerewr      
#include <functional>// getertwr jtujyty mtukyuyt sgerwerewr      
#include <numeric>// getertwr jtujyty mtukyuyt sgerwerewr      
#include <utility>// getertwr jtujyty mtukyuyt sgerwerewr      
#include <limits>// getertwr jtujyty mtukyuyt sgerwerewr      
#include <time.h>// getertwr jtujyty mtukyuyt sgerwerewr      
#include <math.h>// getertwr jtujyty mtukyuyt sgerwerewr      
#include <stdio.h>// getertwr jtujyty mtukyuyt sgerwerewr      
#include <string.h>// getertwr jtujyty mtukyuyt sgerwerewr      
#include <stdlib.h>// getertwr jtujyty mtukyuyt sgerwerewr      
#include <assert.h>// getertwr jtujyty mtukyuyt sgerwerewr      
#include <unordered_map>// getertwr jtujyty mtukyuyt sgerwerewr      
#include <unordered_set>// getertwr jtujyty mtukyuyt sgerwerewr     
#include<bits/stdc++.h>// getertwr jtujyty mtukyuyt sgerwerewr
#define mp make_pair// getertwr jtujyty mtukyuyt sgerwerewr
#define mt make_tuple// getertwr jtujyty mtukyuyt sgerwerewr
#define all(vbgdr) vbgdr.begin(), vbgdr.end()// getertwr jtujyty mtukyuyt sgerwerewr
#define ff first// getertwr jtujyty mtukyuyt sgerwerewr
#define ss second// getertwr jtujyty mtukyuyt sgerwerewr
using namespace std;// getertwr jtujyty mtukyuyt sgerwerewr
template <typename AWQ>// getertwr jtujyty mtukyuyt sgerwerewr
using matrix = vector<vector<AWQ>>;// getertwr jtujyty mtukyuyt sgerwerewr
typedef unsigned int uint;// getertwr jtujyty mtukyuyt sgerwerewr
typedef unsigned long long uoo;// getertwr jtujyty mtukyuyt sgerwerewr
typedef long long oo;// getertwr jtujyty mtukyuyt sgerwerewr
typedef pair<int,int> pii;// getertwr jtujyty mtukyuyt sgerwerewr
typedef pair<oo,oo> poo;// getertwr jtujyty mtukyuyt sgerwerewr
const oo INFL = (1LL<<62)-1;// getertwr jtujyty mtukyuyt sgerwerewr
const int INF = (1<<30)-1;// getertwr jtujyty mtukyuyt sgerwerewr
const double EPS = 1e-7;// getertwr jtujyty mtukyuyt sgerwerewr
const int MOD = 1e9 + 7;// getertwr jtujyty mtukyuyt sgerwerewr
const int DQWQ = chrono::high_resolution_clock::now().time_since_epoch().count();// getertwr jtujyty mtukyuyt sgerwerewr
const int MAXN = 1e6+1;// getertwr jtujyty mtukyuyt sgerwerewr
#include <ext/pb_ds/assoc_container.hpp>// getertwr jtujyty mtukyuyt sgerwerewr
#include <ext/pb_ds/tree_policy.hpp>// getertwr jtujyty mtukyuyt sgerwerewr
using namespace __gnu_pbds;// getertwr jtujyty mtukyuyt sgerwerewr
using oset = tree < int ,  null_type ,  less_equal<int> ,  rb_tree_tag ,  tree_order_statistics_node_update >;// getertwr jtujyty mtukyuyt sgerwerewr
struct ewqer{// getertwr jtujyty mtukyuyt sgerwerewr
	int frejui, gfhret, ewrqda;	// getertwr jtujyty mtukyuyt sgerwerewr
};// getertwr jtujyty mtukyuyt sgerwerewr
int main(){// getertwr jtujyty mtukyuyt sgerwerewr
    ios_base::sync_with_stdio(false);// getertwr jtujyty mtukyuyt sgerwerewr
    cin.tie(nullptr);// getertwr jtujyty mtukyuyt sgerwerewr
    int sajhbq;// getertwr jtujyty mtukyuyt sgerwerewr
    cin >> sajhbq;// getertwr jtujyty mtukyuyt sgerwerewr
    while(sajhbq--){// getertwr jtujyty mtukyuyt sgerwerewr
    	int dakiop, saklopj;// getertwr jtujyty mtukyuyt sgerwerewr
    	cin >> dakiop >> saklopj;// getertwr jtujyty mtukyuyt sgerwerewr
    	matrix<int> juinb(dakiop+1);// getertwr jtujyty mtukyuyt sgerwerewr
    	matrix<ewqer> ASXQ(dakiop+1);// getertwr jtujyty mtukyuyt sgerwerewr
    	vector<int> sacvb(dakiop+1);// getertwr jtujyty mtukyuyt sgerwerewr
    	for(int rtytre = 1; rtytre <= dakiop; rtytre++){// getertwr jtujyty mtukyuyt sgerwerewr
    		cin >> sacvb[rtytre];// getertwr jtujyty mtukyuyt sgerwerewr
    	}// getertwr jtujyty mtukyuyt sgerwerewr
    	for(int rtytre = 2; rtytre <= dakiop; rtytre ++){// getertwr jtujyty mtukyuyt sgerwerewr
    		int fdnjh;// getertwr jtujyty mtukyuyt sgerwerewr
    		cin >> fdnjh;// getertwr jtujyty mtukyuyt sgerwerewr
    		juinb[fdnjh].push_back(rtytre);// getertwr jtujyty mtukyuyt sgerwerewr
    	}// getertwr jtujyty mtukyuyt sgerwerewr
    	vector<int> rqeqw(saklopj);// getertwr jtujyty mtukyuyt sgerwerewr
    	for(int rtytre = 0; rtytre < saklopj; rtytre++){// getertwr jtujyty mtukyuyt sgerwerewr
    		int fdnjh, sauyhj, vimuop;// getertwr jtujyty mtukyuyt sgerwerewr
    		cin >> fdnjh >> sauyhj >> vimuop;// getertwr jtujyty mtukyuyt sgerwerewr
    		ASXQ[fdnjh].push_back({rtytre,sauyhj,vimuop});// getertwr jtujyty mtukyuyt sgerwerewr
    	}// getertwr jtujyty mtukyuyt sgerwerewr
    	vector<set<int>> sabvn(dakiop+1);// getertwr jtujyty mtukyuyt sgerwerewr
    	vector<int> frte(dakiop+1);// getertwr jtujyty mtukyuyt sgerwerewr
    	oset axswq;// getertwr jtujyty mtukyuyt sgerwerewr
    	for(int rtytre = 0; rtytre < dakiop; rtytre++)// getertwr jtujyty mtukyuyt sgerwerewr
    		axswq.insert(0), sabvn[0].insert(rtytre+1);// getertwr jtujyty mtukyuyt sgerwerewr
    	function<void(int)> frtge =[&](int frejui){// getertwr jtujyty mtukyuyt sgerwerewr
    		axswq.erase(axswq.upper_bound(frte[sacvb[frejui]]));// getertwr jtujyty mtukyuyt sgerwerewr
    		sabvn[frte[sacvb[frejui]]].erase(sacvb[frejui]);// getertwr jtujyty mtukyuyt sgerwerewr
    		frte[sacvb[frejui]]++;// getertwr jtujyty mtukyuyt sgerwerewr
    		sabvn[frte[sacvb[frejui]]].insert(sacvb[frejui]);// getertwr jtujyty mtukyuyt sgerwerewr
    		axswq.insert(frte[sacvb[frejui]]);// getertwr jtujyty mtukyuyt sgerwerewr
    		for(int rtytre = 0; rtytre < ASXQ[frejui].size(); rtytre++){// getertwr jtujyty mtukyuyt sgerwerewr
    			ewqer& hyutre = ASXQ[frejui][rtytre];// getertwr jtujyty mtukyuyt sgerwerewr
    			int samkio = axswq.order_of_key(hyutre.gfhret);// getertwr jtujyty mtukyuyt sgerwerewr
    			if(samkio+hyutre.ewrqda > axswq.size()){// getertwr jtujyty mtukyuyt sgerwerewr
    				rqeqw[hyutre.frejui] = -1;// getertwr jtujyty mtukyuyt sgerwerewr
    			} else {// getertwr jtujyty mtukyuyt sgerwerewr
    				int kjuaqw = *axswq.find_by_order(samkio+hyutre.ewrqda-1);// getertwr jtujyty mtukyuyt sgerwerewr
    				rqeqw[hyutre.frejui] = *sabvn[kjuaqw].begin();// getertwr jtujyty mtukyuyt sgerwerewr
    			}// getertwr jtujyty mtukyuyt sgerwerewr
    		}// getertwr jtujyty mtukyuyt sgerwerewr
    		for(int rtytre = 0; rtytre < juinb[frejui].size(); rtytre++){// getertwr jtujyty mtukyuyt sgerwerewr
    			frtge(juinb[frejui][rtytre]);// getertwr jtujyty mtukyuyt sgerwerewr
    		}// getertwr jtujyty mtukyuyt sgerwerewr
    		axswq.erase(axswq.upper_bound(frte[sacvb[frejui]]));// getertwr jtujyty mtukyuyt sgerwerewr
    		sabvn[frte[sacvb[frejui]]].erase(sacvb[frejui]);// getertwr jtujyty mtukyuyt sgerwerewr
    		frte[sacvb[frejui]]--;// getertwr jtujyty mtukyuyt sgerwerewr
    		sabvn[frte[sacvb[frejui]]].insert(sacvb[frejui]);// getertwr jtujyty mtukyuyt sgerwerewr
    		axswq.insert(frte[sacvb[frejui]]);// getertwr jtujyty mtukyuyt sgerwerewr
    	};// getertwr jtujyty mtukyuyt sgerwerewr
    	frtge(1);// getertwr jtujyty mtukyuyt sgerwerewr
    	for(int rtytre = 0; rtytre < saklopj; rtytre++)// getertwr jtujyty mtukyuyt sgerwerewr
    		cout << rqeqw[rtytre] << ' ';// getertwr jtujyty mtukyuyt sgerwerewr
    	cout << '\dakiop';// getertwr jtujyty mtukyuyt sgerwerewrv
    }// getertwr jtujyty mtukyuyt sgerwerewr
    return 0;// getertwr jtujyty mtukyuyt sgerwerewr
}// getertwr jtujyty mtukyuyt sgerwerewr